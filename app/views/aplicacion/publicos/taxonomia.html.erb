<!-- TITULO -->
<%= render partial: 'taxonomia/filo_elementos/partials/titulo/titulo_elemento', locals: {objeto: @objeto, padres: @padres, params_indice: params[:indice]} %>

<%= render partial: 'taxonomia/filo_elementos/partials/cllps/cllps_display_all', locals: {objeto: @objeto} %>

<div class="tax-box">

	<div class="row">
		<div class="col-lg-6 col-xs-12">

			<% if @coleccion['base-filo_elementos'].count > cfg_taxonomia[:elem_base_max] %>
				<%= render partial: 'taxonomia/filo_elementos/partials/line/no_hijos_msg', locals: {objeto: @objeto} %>
			<% end %>
			<!-- SIEMPRE SE DESPLIEGAN TODOS LOS ELEMENTOS BASE -->
			<% @coleccion['base-filo_elementos'].each do |elemento| %>
				<div class="elemento">
					<%= render partial: 'taxonomia/filo_elementos/partials/line/line_elemento', locals: {objeto: elemento} %>

					<!-- SI LOS ELEMENTOS BASE SUPERAN EL MAXIMO, NO SE DESPLIEGAN SUS HIJOS -->
					<% unless @coleccion['base-filo_elementos'].count > cfg_taxonomia[:elem_base_max] %>
						<small>
						<div style='padding-left: 2em'>
							<!-- DESPLIEGUE MÁXIMO DE SUB ELEMENTOS -->
							<% if elemento.children.count > cfg_taxonomia[:elem_dsply_max] %>
								<%= render partial: 'taxonomia/filo_elementos/partials/line/no_display_msg', locals: {objeto: elemento} %>
							<% else %>
								<% elemento.children.order(:filo_elemento).each do |sub_elemento| %>
									<%= render partial: 'taxonomia/filo_elementos/partials/line/line_elemento', locals: {objeto: sub_elemento} %>
								<% end %>
							<% end %>
						</div>
						<div style='padding-left: 2em'>
							<!-- DESPLIEGUE MÁXIMO ESPECIES -->
							<% if elemento.filo_especies.count > cfg_taxonomia[:esp_dsply_max] %>
								<%= render partial: 'taxonomia/filo_especies/partials/line/no_display_msg', locals: {objeto: elemento} %>
							<% else %>
								<% elemento.filo_especies.order(:filo_especies).each do |especie| %>
									<%= render partial: 'taxonomia/filo_especies/partials/line_especie', locals: {objeto: especie} %>
								<% end %>
							<% end %>
						</div>
						</small>
					<% end %>
				</div>
			<% end %>

			<!-- NO SE DESPLIEGAN ESPECIES EN BASE -->
			<% unless @objeto.blank? %>
				<% if @coleccion['filo_especies'].count > cfg_taxonomia[:esp_base_max] %>
					<%= render partial: 'taxonomia/filo_especies/partials/line/no_hijos_msg', locals: {objeto: @objeto} %>
				<% end %>
				<!-- SIEMPRE SE DESPLIEGAN TODAS LAS ESPECIES DEL ELEMENTO -->
				<% @coleccion['filo_especies'].each do |especie| %>
					<%= render partial: 'taxonomia/filo_especies/partials/line/line_especie', locals: {objeto: especie} %>

					<% unless @coleccion['filo_especies'].count > cfg_taxonomia[:esp_base_max] %>
						<small>
						<div class="sub_especies" style='padding-left: 2em'>
							<% if especie.children.count > config[:taxonomia][:esp_count] %>
								<div style="padding-left: <%= especie.n_indent %>em; line-height: 18px;">
									<small><i class="bi bi-stoplights"></i> Sub especies no fueron desplegados para optimizar despliegue,</br> para verlas acceda a la especie! </small>
								</div>
							<% else %>
								<% especie.children.order(:filo_especies).each do |sub_especie| %>
									<%= render partial: 'taxonomia/filo_especies/partials/line/line_especie', locals: {objeto: sub_especie} %>
								<% end %>
							<% end %>
						</div>
						</small>
					<% end %>

				<% end %>

			<% end %>
		</div>
		<div class="col-lg-6 col-xs-12"></div>
	</div>

</div>